!function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(o,n,function(e){return t[e]}.bind(null,n));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/bundles/administration/",r(r.s="iaiY")}({"6TET":function(t,e,r){},"8Pjr":function(t,e){t.exports='{% block comme_product_configurator_products_list %}\n    <sw-page class="sas-blog-author-list">\n        <template slot="smart-bar-header">\n            <h2>\n                {% block comme_product_configurator_products_list_smart_bar_header_title_text %}\n                    Product Configurator Products\n                {% endblock %}\n            </h2>\n        </template>\n        {% block comme_product_configurator_products_list_smart_bar_actions %}\n            <template slot="smart-bar-actions">\n                {% block comme_product_configurator_products_list_smart_bar_actions_add %}\n                    <sw-button :routerLink="{ name: \'comme.product.configurator.commeProductConfiguratorProductsCreate\' }" variant="danger">\n                        Create new product\n                    </sw-button>\n                {% endblock %}\n            </template>\n        {% endblock %}\n        <template #content>\n            {% block comme_product_configurator_products_list_content %}\n                <sw-entity-listing\n                    :repository="productConfiguratorProductsRepository"\n                    :items="products"\n                    :showSelection="false"\n                    detailRoute="comme.product.configurator.categoryDetail"\n                    :columns="columns">\n                </sw-entity-listing>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n\n'},OApL:function(t){t.exports=JSON.parse('{"comme-product-configurator":{"nested":{"value":"example"},"title":"CPC"},"comme-product-configurator-products":{"general":{"tab-item":"Product Configurator","list-title":"Comme Product Configurator Products list page","detail-title":"Comme Product Configurator Products detail page"},"empty-message":{"message":"Nema scena"},"comme-product-configurator-products-save-success":{"message":"Product Configurator Product has been successfully created","title":"Product Configurator Product saved"},"comme-product-configurator-products-update-success":{"message":"Product Configurator Product has been successfully updated"},"create":{"isActive":"Is active","title":"Title","slug":"Slug","descriptionHeader":"Description header","descriptionFooter":"Description footer"}},"comme-product-configurator-products-seo":{"slug-exists":{"message":"One of the entered slugs already exists"},"slug-empty":{"message":"Slug cannot be empty"}}}')},SZ7m:function(t,e,r){"use strict";function o(t,e){for(var r=[],o={},n=0;n<e.length;n++){var c=e[n],i=c[0],s={id:t+":"+n,css:c[1],media:c[2],sourceMap:c[3]};o[i]?o[i].parts.push(s):r.push(o[i]={id:i,parts:[s]})}return r}r.r(e),r.d(e,"default",(function(){return h}));var n="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!n)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var c={},i=n&&(document.head||document.getElementsByTagName("head")[0]),s=null,a=0,u=!1,d=function(){},l=null,p="data-vue-ssr-id",f="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(t,e,r,n){u=r,l=n||{};var i=o(t,e);return m(i),function(e){for(var r=[],n=0;n<i.length;n++){var s=i[n];(a=c[s.id]).refs--,r.push(a)}e?m(i=o(t,e)):i=[];for(n=0;n<r.length;n++){var a;if(0===(a=r[n]).refs){for(var u=0;u<a.parts.length;u++)a.parts[u]();delete c[a.id]}}}}function m(t){for(var e=0;e<t.length;e++){var r=t[e],o=c[r.id];if(o){o.refs++;for(var n=0;n<o.parts.length;n++)o.parts[n](r.parts[n]);for(;n<r.parts.length;n++)o.parts.push(P(r.parts[n]));o.parts.length>r.parts.length&&(o.parts.length=r.parts.length)}else{var i=[];for(n=0;n<r.parts.length;n++)i.push(P(r.parts[n]));c[r.id]={id:r.id,refs:1,parts:i}}}}function g(){var t=document.createElement("style");return t.type="text/css",i.appendChild(t),t}function P(t){var e,r,o=document.querySelector("style["+p+'~="'+t.id+'"]');if(o){if(u)return d;o.parentNode.removeChild(o)}if(f){var n=a++;o=s||(s=g()),e=b.bind(null,o,n,!1),r=b.bind(null,o,n,!0)}else o=g(),e=C.bind(null,o),r=function(){o.parentNode.removeChild(o)};return e(t),function(o){if(o){if(o.css===t.css&&o.media===t.media&&o.sourceMap===t.sourceMap)return;e(t=o)}else r()}}var y,v=(y=[],function(t,e){return y[t]=e,y.filter(Boolean).join("\n")});function b(t,e,r,o){var n=r?"":o.css;if(t.styleSheet)t.styleSheet.cssText=v(e,n);else{var c=document.createTextNode(n),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(c,i[e]):t.appendChild(c)}}function C(t,e){var r=e.css,o=e.media,n=e.sourceMap;if(o&&t.setAttribute("media",o),l.ssrId&&t.setAttribute(p,e.id),n&&(r+="\n/*# sourceURL="+n.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}},dOlM:function(t,e,r){},iaiY:function(t,e,r){"use strict";r.r(e);var o=r("j08e"),n=r("OApL"),c=r("8Pjr"),i=r.n(c),s=(r("sipq"),Shopware.Data.Criteria);Shopware.Component.register("comme-product-configurator-products-list",{template:i.a,data:function(){return{isLoading:!1,total:0,productConfiguratorProducts:null,products:null}},inject:["repositoryFactory"],mixins:["notification","listing","placeholder"],computed:{columns:function(){return[{property:"id",label:"Product ID",allowResize:!0,routerLink:"comme.product.configurator.commeProductConfiguratorProductsDetail",primary:!0},{property:"translated.name",label:"Parent product",allowResize:!0},{property:"price[0].net",label:"Price",allowResize:!0}]},productConfiguratorProductsRepository:function(){return this.repositoryFactory.create("comme_product_configurator_products")},productRepository:function(){return this.repositoryFactory.create("product")}},created:function(){var t=this;this.productConfiguratorProductsRepository.search(new s,Shopware.Context.api).then((function(e){t.productConfiguratorProducts=t.uniqueElements(e,"parentProductId");var r=[];if(t.productConfiguratorProducts.forEach((function(t){r.push(t.parentProductId)})),r.length>0){var o=new s;o.setIds(r),t.productRepository.search(o,Shopware.Context.api).then((function(e){t.products=e}))}else t.products=[]}))},methods:{uniqueElements:function(t,e){return t.filter((function(t,r,o){return o.map((function(t){return t[e]})).indexOf(t[e])===r}))}}});var a=r("lAfa"),u=r.n(a);function d(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}Shopware.Component.extend("comme-product-configurator-products-create","comme-product-configurator-products-detail",{template:u.a,methods:{createdComponent:function(){this.getProduct(),this.getProducts(),this.selectedChildProducts=[],this.childProducts=[],this.disabledInput=!0,this.disabledParentProduct=!1},getProduct:function(){this.product=this.productConfiguratorProductsRepository.create("comme_product_configurator_products")},loadAddedProduct:function(){var t=this;this.productConfiguratorProductsRepository.get(this.$route.params.id,Shopware.Context.api,new Criteria).then((function(e){t.product=e}))},onClickSave:function(){var t=this;this.isLoading=!0;var e=Shopware.Service("syncService"),r=e.httpClient,o=e.getBasicHeaders();""!==this.selectedParentProduct&&null!==this.selectedParentProduct&&this.selectedChildProducts.length>0?r.get("/_action/validate-parent-product/".concat(this.selectedParentProduct),{headers:o}).then((function(e){if(t.isLoading=!1,e.data>0){t.createNotificationError({title:"Error: Product not saved properly",message:"Chosen parent product already exists!"})}else{t.selectedChildProducts.forEach((function(e){t.childProducts=[].concat(d(t.childProducts),[e.id])}));var n=t.childProducts;r.post("/_action/save-product/".concat(t.selectedParentProduct),{headers:o,childProducts:n}).then((function(e){r.post("/_action/product-seo-create/".concat(t.selectedParentProduct),{headers:o}).then((function(e){t.createNotificationSuccess({title:t.$tc("global.default.success"),message:t.$tc("comme-product-configurator-products.comme-product-configurator-products-save-success.message")}),t.$router.replace({path:"/comme/product/configurator/index"})}))}))}})):this.createNotificationError({title:"Error while creating a new product",message:"All fields must be entered"}),this.isLoading=!1,this.processSuccess=!0}}});r("wdTR");function p(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return f(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}var h=Shopware,m=h.Mixin,g=h.StateDeprecated,P=Shopware.Data.Criteria;Shopware.Component.register("comme-product-configurator-products-detail",{template:u.a,inject:["repositoryFactory"],mixins:[m.getByName("notification")],metaInfo:function(){return{title:this.$createTitle()}},data:function(){return{product:null,products:[],selectedParentProduct:null,selectedChildProducts:[],productIds:[],existingChildProducts:[],childProducts:[],languageId:Shopware.Context.api.languageId,isLoading:!1,processSuccess:!1,httpClient:null,syncService:null,entity:null,limit:25,seoUrl:{seoPathInfo:""},existingSeoUrl:{seoPathInfo:""},disabledInput:!1,disabledParentProduct:!0}},computed:{productConfiguratorProductsRepository:function(){return this.repositoryFactory.create("comme_product_configurator_products")},productRepository:function(){return this.repositoryFactory.create("product")},seoUrlRepository:function(){return this.repositoryFactory.create("seo_url")},languageRepository:function(){return this.repositoryFactory.create("language")},languageStore:function(){return g.getStore("language")}},created:function(){this.createdComponent()},methods:{createdComponent:function(){this.getProduct(),this.getProducts(),this.syncService=Shopware.Service("syncService"),this.httpClient=this.syncService.httpClient},getProduct:function(){var t=this,e=new P;e.addFilter(P.equals("parentProductId",this.$route.params.id)),this.productConfiguratorProductsRepository.search(e,Shopware.Context.api,new P).then((function(e){t.product=e[0],t.selectedParentProduct=e[0].parentProductId,t.getExistingChildProducts(),t.getSeoUrl(),t.getSeoUrlBackup()}))},getExistingChildProducts:function(){var t=this;this.productConfiguratorProductsRepository.search(new P,Shopware.Context.api).then((function(e){if(t.products=[],t.existingChildProducts=[],e.forEach((function(e){e.parentProductId==t.selectedParentProduct&&t.existingChildProducts.push(e.childProductId)})),t.existingChildProducts.length>0){var r=new P;r.setIds(t.existingChildProducts),t.productRepository.search(r,Shopware.Context.api).then((function(e){t.products=[],t.selectedChildProducts=[],e.forEach((function(e){t.selectedChildProducts.push(e)}))}))}}))},getProducts:function(){var t=this;this.productRepository.search(new P,Shopware.Context.api).then((function(e){t.products=[],e.forEach((function(e){t.products.push(e)}))}))},getSeoUrl:function(){var t=this;this.httpClient.get("/_action/get-seo-url/".concat(this.selectedParentProduct),{headers:this.syncService.getBasicHeaders()}).then((function(e){null!=e.data?t.seoUrl=e.data:t.seoUrl=t.seoUrlRepository.create("seo_url")})).catch((function(e){t.isLoading=!1,t.createNotificationError({title:"Error while saving the Category",message:e})}))},getSeoUrlBackup:function(){var t=this;this.httpClient.get("/_action/get-seo-url/".concat(this.selectedParentProduct),{headers:this.syncService.getBasicHeaders()}).then((function(e){null!=e.data?t.existingSeoUrl=e.data:t.existingSeoUrl=t.seoUrlRepository.create("seo_url")})).catch((function(e){t.isLoading=!1,t.createNotificationError({title:"Error while saving the Category",message:e})}))},setSelectedParentProduct:function(t){this.selectedParentProduct=t},setSelectedChildProducts:function(t){this.selectedChildProducts=t},saveProductChanges:function(){var t=this;this.selectedChildProducts.forEach((function(e){t.childProducts=[].concat(p(t.childProducts),[e.id])}));var e=this.childProducts;this.httpClient.post("/_action/save-product/".concat(this.selectedParentProduct),{headers:this.syncService.getBasicHeaders(),childProducts:e}).then((function(e){t.createNotificationSuccess({title:t.$tc("global.default.success"),message:t.$tc("comme-product-configurator-products.comme-product-configurator-products-update-success.message")}),t.$router.replace({path:"/comme/product/configurator/index"})}))},onClickSave:function(){var t=this;this.isLoading=!0,""!==this.selectedParentProduct&&null!==this.selectedParentProduct&&this.selectedChildProducts.length>0&&""!==this.seoUrl.seoPathInfo?(this.seoUrl.seoPathInfo=this.seoUrl.seoPathInfo.replace(/ /g,""),this.seoUrl.seoPathInfo!==this.existingSeoUrl.seoPathInfo?this.httpClient.get("/_action/validate-seo-url/".concat(this.seoUrl.seoPathInfo),{headers:this.syncService.getBasicHeaders()}).then((function(e){if(t.isLoading=!1,e.data>0){t.createNotificationError({title:"Error: Product not saved properly",message:"Entered seo url already exists"}),t.getSeoUrl(),t.getSeoUrlBackup()}else t.seoUrlRepository.get(t.seoUrl.id,Shopware.Context.api).then((function(e){t.entity=e,t.entity.seoPathInfo=t.seoUrl.seoPathInfo,t.seoUrlRepository.save(t.entity,Shopware.Context.api).then((function(){t.saveProductChanges()}))}))})):this.saveProductChanges()):this.createNotificationError({title:"Error while saving product",message:"All fields must be entered"}),this.isLoading=!1,this.processSuccess=!0},saveFinish:function(){this.processSuccess=!1}}});var y=r("wX3M"),v=r.n(y);Shopware.Component.register("comme-product-configurator-vertical-main-tabs",{template:v.a,props:{defaultItem:{type:String,default:"blog"}},methods:{onChangeTab:function(t){this.currentTab=t}}}),Shopware.Module.register("comme-product-configurator",{type:"plugin",name:"comme product configurator",color:"#ff3d58",icon:"default-object-lab-flask",snippets:{"de-DE":o,"en-GB":n},routes:{index:{component:"comme-product-configurator-products-list",path:"index"},commeProductConfiguratorProductsDetail:{component:"comme-product-configurator-products-detail",path:"commeProductConfiguratorProductsDetail/:id",props:{default:function(t){return{commeProductConfiguratorProductsId:t.params.id}}},meta:{parentPath:"comme.product.configurator.index"}},commeProductConfiguratorProductsCreate:{component:"comme-product-configurator-products-create",path:"commeProductConfiguratorProductsCreate",meta:{parentPath:"comme.product.configurator.index"}}},navigation:[{id:"comme-product-configurator",label:"comme-product-configurator.title",color:"#ff3d58",path:"comme.product.configurator.index",icon:"default-object-lab-flask",parent:"sw-extension",position:90}]})},j08e:function(t){t.exports=JSON.parse('{"comme-product-configurator":{"nested":{"value":"example"},"title":"CPC"},"comme-product-configurator-products":{"general":{"tab-item":"Product Configurator","list-title":"Comme Product Configurator Products list page","detail-title":"Comme Product Configurator Products detail page"},"empty-message":{"message":"Nema scena"},"comme-product-configurator-products-save-success":{"message":"Product Configurator Product has been successfully created","title":"Product Configurator Product saved"},"comme-product-configurator-products-update-success":{"message":"Product Configurator Product has been successfully updated"},"create":{"isActive":"Is active","title":"Title","slug":"Slug","descriptionHeader":"Description header","descriptionFooter":"Description footer"}},"comme-product-configurator-products-seo":{"slug-exists":{"message":"One of the entered slugs already exists"},"slug-empty":{"message":"Slug cannot be empty"}}}')},lAfa:function(t,e){t.exports='<sw-page>\n    <template slot="smart-bar-header">\n        <h2>\n            {% block comme_product_configurator_products_list_smart_bar_header_title_text %}\n                Product Detail Page\n            {% endblock %}\n        </h2>\n    </template>\n    <template slot="smart-bar-actions">\n        <sw-button-process\n            :isLoading="isLoading"\n            :processSuccess="processSuccess"\n            variant="danger"\n            @process-finish="saveFinish"\n            @click="onClickSave">\n            Save\n        </sw-button-process>\n    </template>\n    <template slot="content">\n        <sw-card-view>\n            <sw-card>\n                {% block comme_product_configurator_products_single_select %}\n                    <sw-entity-single-select\n                        label="Choose the parent product"\n                        :options="products"\n                        :value="selectedParentProduct"\n                        entity="product"\n                        :display-variants="true"\n                        @change="setSelectedParentProduct"\n                        :disabled="disabledParentProduct"\n                        >\n                    </sw-entity-single-select>\n                {% endblock %}\n                {% block comme_product_configurator_products_multi_select %}\n                    <sw-entity-multi-select\n                        label="Choose the child products"\n                        :entityCollection="selectedChildProducts"\n                        entityName="product"\n                        :display-variants="true"\n                        @change="setSelectedChildProducts">\n                    </sw-entity-multi-select>\n                {% endblock %}\n                <sw-field v-model="seoUrl.seoPathInfo" label="Seo url" :disabled="disabledInput"></sw-field>\n            </sw-card>\n        </sw-card-view>\n    </template>\n</sw-page>\n'},sipq:function(t,e,r){var o=r("dOlM");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,r("SZ7m").default)("27a53eba",o,!0,{})},wX3M:function(t,e){t.exports='<sw-tabs isVertical :defaultItem="defaultItem" :small="false" class="sw-shop-the-look-tabs" @new-item-active="onChangeTab" >\n    <template #default="{ active }">\n        {% block sas_block_list_tab_item %}\n            <sw-tabs-item\n                variant="minimal"\n                :route="{ name: \'comme.product.configurator.index\' }"\n                :activeTab="active"\n                :native="true"\n                name="Product configurator">\n                {{ $tc(\'comme-product-configurator-products.general.tab-item\') }}\n            </sw-tabs-item>\n        {% endblock %}\n    </template>\n</sw-tabs>\n'},wdTR:function(t,e,r){var o=r("6TET");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);(0,r("SZ7m").default)("6685f58d",o,!0,{})}});